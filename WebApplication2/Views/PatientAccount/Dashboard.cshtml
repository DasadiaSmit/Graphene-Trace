@{
ViewData["Title"] = "Dashboard";
}

<div class="container mt-4">

	<!-- AUTO ALERT BOX -->
	<div id="alertBox"
         style="display:none; padding:20px; background-color:#ff3b30; color:white;
         border-radius:10px; font-size:20px; font-weight:bold; margin-bottom:20px;">
	</div>

	<h2>Patient Dashboard</h2>

	<p>Emergency button will immediately notify your clinician.</p>

	<!-- 🚨 EMERGENCY BUTTON -->
	<button id="emergencyBtn"
            style="padding:15px 25px; background-color:#d9534f; color:white; 
            border:none; border-radius:8px; font-size:18px; cursor:pointer;">
		🚨 SEND EMERGENCY ALERT
	</button>

	<div id="emergencyMsg" style="margin-top:20px; font-size:18px; font-weight:bold;"></div>
</div>

<script>
	function checkAlert() {
	fetch('/Alert/CheckAlert')
	.then(r => r.json())
	.then(data => {
	const box = document.getElementById('alertBox');
	if (data.alert === true) {
	box.style.display = "block";
	box.innerHTML = "⚠️ " + data.message;
	} else {
	box.style.display = "none";
	}
	});
	}

	setInterval(checkAlert, 5000);
	checkAlert();

	// 🚨 EMERGENCY BUTTON LOGIC
	document.getElementById("emergencyBtn").addEventListener("click", function () {
	fetch('/Alert/Emergency', {
	method: 'POST'
	})
	.then(r => r.json())
	.then(data => {
	document.getElementById("emergencyMsg").innerHTML =
	"✔ " + data.message;
	});
	});
</script>
